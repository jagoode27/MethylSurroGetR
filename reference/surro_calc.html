<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate Predicted Values from methyl_surro Object — surro_calc • MethylSurroGetR</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate Predicted Values from methyl_surro Object — surro_calc"><meta name="description" content="This function calculates predicted values based on the provided methyl_surro object.
If any probes (rows) are completely missing, their values are set to zero.
Samples with any missing values are removed from the calculation. The function aligns
and multiplies the weights with the methylation matrix, adds the intercept if specified,
and applies the specified transformation to the results."><meta property="og:description" content="This function calculates predicted values based on the provided methyl_surro object.
If any probes (rows) are completely missing, their values are set to zero.
Samples with any missing values are removed from the calculation. The function aligns
and multiplies the weights with the methylation matrix, adds the intercept if specified,
and applies the specified transformation to the results."><meta property="og:image" content="https://jagoode27.github.io/MethylSurroGetR/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MethylSurroGetR</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html" aria-label="Home"><span class="fa fas fa-home fa-lg"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/MethylSurroGetR.html">Getting Started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jagoode27/MethylSurroGetR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate Predicted Values from methyl_surro Object</h1>
      <small class="dont-index">Source: <a href="https://github.com/jagoode27/MethylSurroGetR/blob/master/R/surro_calc.R" class="external-link"><code>R/surro_calc.R</code></a></small>
      <div class="d-none name"><code>surro_calc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function calculates predicted values based on the provided methyl_surro object.
If any probes (rows) are completely missing, their values are set to zero.
Samples with any missing values are removed from the calculation. The function aligns
and multiplies the weights with the methylation matrix, adds the intercept if specified,
and applies the specified transformation to the results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">surro_calc</span><span class="op">(</span></span>
<span>  <span class="va">methyl_surro</span>,</span>
<span>  transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"linear"</span>, <span class="st">"count"</span>, <span class="st">"probability"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  return_diagnostics <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-methyl-surro">methyl_surro<a class="anchor" aria-label="anchor" href="#arg-methyl-surro"></a></dt>
<dd><p>An object of class <code>methyl_surro</code>.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>A character string specifying the transformation to apply. Can be <code>"linear"</code>, <code>"count"</code>, or <code>"probability"</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, detailed progress and diagnostic messages are displayed. Default is <code>FALSE</code>.</p></dd>


<dt id="arg-return-diagnostics">return_diagnostics<a class="anchor" aria-label="anchor" href="#arg-return-diagnostics"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, returns additional diagnostic information. Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If <code>return_diagnostics = FALSE</code>: A named vector of predicted values with names corresponding to the sample names.
If <code>return_diagnostics = TRUE</code>: A list containing:</p><dl><dt>predictions</dt>
<dd><p>The named vector of predicted values</p></dd>

<dt>diagnostics</dt>
<dd><p>A list of diagnostic information including missing data handling and calculation details</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function performs validation and processing steps:</p><ul><li><p>Validates probe-weight alignment between methylation data and weights</p></li>
<li><p>Sets completely missing probes to zero</p></li>
<li><p>Removes samples with any missing values</p></li>
<li><p>Calculates weighted sums and applies transformations</p></li>
<li><p>Provides detailed feedback about data processing</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load sample data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">beta_matrix_comp</span>, package <span class="op">=</span> <span class="st">"MethylSurroGetR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">wts_df</span>, package <span class="op">=</span> <span class="st">"MethylSurroGetR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create weight vector and methyl_surro object</span></span></span>
<span class="r-in"><span><span class="va">wts_vec_lin</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">wts_df</span><span class="op">$</span><span class="va">wt_lin</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">wts_df</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">methyl_surro_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="surro_set.html">surro_set</a></span><span class="op">(</span><span class="va">beta_matrix_comp</span>, <span class="va">wts_vec_lin</span>, <span class="st">"Intercept"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Added 5 missing probes with NA values (50.0% of weight probes missing from methylation data).</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Filtered methylation matrix from 15 to 10 probes to match weights.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic calculation</span></span></span>
<span class="r-in"><span><span class="va">pred_lin</span> <span class="op">&lt;-</span> <span class="fu">surro_calc</span><span class="op">(</span><span class="va">methyl_surro_comp</span>, transform <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 probes set to zero. Use reference_fill().</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pred_lin</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    samp1    samp2    samp3    samp4    samp5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.196622 1.199377 1.205871 1.198700 1.197060 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With diagnostic information</span></span></span>
<span class="r-in"><span><span class="va">result_detailed</span> <span class="op">&lt;-</span> <span class="fu">surro_calc</span><span class="op">(</span><span class="va">methyl_surro_comp</span>,</span></span>
<span class="r-in"><span>                              transform <span class="op">=</span> <span class="st">"linear"</span>,</span></span>
<span class="r-in"><span>                              return_diagnostics <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                              verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Starting surrogate calculation with linear transformation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Input: 10 probes x 5 samples</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Weights: 10 probe weights available</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Intercept: 1.211000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 5 probes set to zero. Use reference_fill().</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculating weighted sum...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Added intercept: 1.211000</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Applying linear transformation...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Calculation completed successfully:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - Final sample count: 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> - Result range: 1.1966 to 1.2059</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">result_detailed</span><span class="op">$</span><span class="va">diagnostics</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $transform</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "linear"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_samples_original</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_probes_original</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intercept_used</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_common_probes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_missing_in_weights</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_missing_in_methyl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_completely_missing_probes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_samples_with_missing</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $probes_set_to_zero</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $samples_removed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $n_final_samples</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $final_result_range</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      min      max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1.196622 1.205871 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/jagoode27" class="external-link">Joshua A. Goode</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

