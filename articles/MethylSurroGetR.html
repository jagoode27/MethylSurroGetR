<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>MethylSurroGetR • MethylSurroGetR</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="MethylSurroGetR">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MethylSurroGetR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/MethylSurroGetR.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jagoode27/MethylSurroGetR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<script src="MethylSurroGetR_files/kePrint-0.0.1/kePrint.js"></script><link href="MethylSurroGetR_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>MethylSurroGetR</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/jagoode27/MethylSurroGetR/blob/master/vignettes/MethylSurroGetR.Rmd" class="external-link"><code>vignettes/MethylSurroGetR.Rmd</code></a></small>
      <div class="d-none name"><code>MethylSurroGetR.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="installing-loading-package">Installing &amp; Loading Package<a class="anchor" aria-label="anchor" href="#installing-loading-package"></a>
</h2>
<p>We can use the <code>devtools</code> package to install the
development version of <code>MethylSurroGetR</code> from GitHub.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"jagoode27/MethylSurroGetR"</span><span class="op">)</span></span></code></pre></div>
<p>Once the package is installed, we can load the package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jagoode27/MethylSurroGetR" class="external-link">MethylSurroGetR</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-sample-data">Loading Sample Data<a class="anchor" aria-label="anchor" href="#loading-sample-data"></a>
</h2>
<p>At a minimum, <code>MethylSurroGetR</code> requires two input
objects: a methylation matrix and a named vector, matrix, or data frame
with surrogate weights.</p>
<div class="section level3">
<h3 id="methylation-matrix">Methylation Matrix<a class="anchor" aria-label="anchor" href="#methylation-matrix"></a>
</h3>
<p>We’ll start by loading our matrix of beta values.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"beta_matrix_miss"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">beta_matrix_miss</span><span class="op">)</span></span>
<span><span class="co">#&gt;          samp1      samp2      samp3     samp4      samp5</span></span>
<span><span class="co">#&gt; cg01 0.1028646 0.32037324 0.48290240        NA 0.36948887</span></span>
<span><span class="co">#&gt; cg02 0.2875775         NA         NA 0.8830174         NA</span></span>
<span><span class="co">#&gt; cg04 0.4348927 0.18769112 0.89035022 0.1422943 0.98421920</span></span>
<span><span class="co">#&gt; cg05 0.9849570 0.78229430 0.91443819 0.5492847 0.15420230</span></span>
<span><span class="co">#&gt; cg07 0.8998250 0.24608773         NA 0.3279207 0.95450365</span></span>
<span><span class="co">#&gt; cg08 0.8895393 0.69280341 0.64050681 0.9942698 0.65570580</span></span>
<span><span class="co">#&gt; cg09        NA 0.09359499 0.60873498 0.9540912         NA</span></span>
<span><span class="co">#&gt; cg10 0.8864691         NA         NA 0.5854834 0.14190691</span></span>
<span><span class="co">#&gt; cg12 0.1750527         NA 0.14709469        NA 0.69000710</span></span>
<span><span class="co">#&gt; cg13 0.9630242 0.90229905 0.69070528 0.7954674 0.02461368</span></span>
<span><span class="co">#&gt; cg14 0.1306957         NA 0.93529980 0.6478935         NA</span></span>
<span><span class="co">#&gt; cg16 0.6531019 0.33282354 0.30122890 0.3198206 0.89139412</span></span>
<span><span class="co">#&gt; cg17 0.1428000 0.41454634 0.41372433 0.3688455 0.15244475</span></span>
<span><span class="co">#&gt; cg19 0.3435165 0.48861303 0.06072057 0.3077200         NA</span></span>
<span><span class="co">#&gt; cg20 0.6567581 0.95447383 0.94772694 0.2197676         NA</span></span></code></pre></div>
<p>Notice that probe IDs are in row names and sample IDs are in column
names. This is the required orientation in
<code>MethylSurroGetR</code>.</p>
</div>
<div class="section level3">
<h3 id="surrogate-weights">Surrogate Weights<a class="anchor" aria-label="anchor" href="#surrogate-weights"></a>
</h3>
<p>Next, we’ll load a named vector of weights to construct the
surrogate.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"wts_vec_lin"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">wts_vec_lin</span><span class="op">)</span></span>
<span><span class="co">#&gt;         cg02         cg03         cg06         cg07         cg08         cg11 </span></span>
<span><span class="co">#&gt; -0.009083377 -0.001155999  0.005978497 -0.007562015  0.001218960 -0.005869372 </span></span>
<span><span class="co">#&gt;         cg13         cg15         cg17         cg18    Intercept </span></span>
<span><span class="co">#&gt; -0.007449367  0.005066157  0.007900907 -0.002510744  1.211000000</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="building-mehtyl_surro-data-object">Building <code>mehtyl_surro</code> Data Object<a class="anchor" aria-label="anchor" href="#building-mehtyl_surro-data-object"></a>
</h2>
<p>In order to generate predicted values from surrogate weights, we need
to construct a <code>mehtyl_surro</code> object. To do this, we will use
the <code><a href="../reference/surro_set.html">surro_set()</a></code> function and specify the methylation matrix
with the <code>methyl</code> and the weights object with the
<code>weights</code> option. In addition, we need to specify the
character string for the name of the intercept in the weights object (if
applicable) with the <code>intercept</code> option.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surro_set.html">surro_set</a></span><span class="op">(</span>methyl <span class="op">=</span> <span class="va">beta_matrix_miss</span>,</span>
<span>                          weights <span class="op">=</span> <span class="va">wts_vec_lin</span>,</span>
<span>                          intercept <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_surrogate</span><span class="op">)</span></span>
<span><span class="co">#&gt; $methyl</span></span>
<span><span class="co">#&gt;          samp1     samp2     samp3     samp4      samp5</span></span>
<span><span class="co">#&gt; cg02 0.2875775        NA        NA 0.8830174         NA</span></span>
<span><span class="co">#&gt; cg07 0.8998250 0.2460877        NA 0.3279207 0.95450365</span></span>
<span><span class="co">#&gt; cg08 0.8895393 0.6928034 0.6405068 0.9942698 0.65570580</span></span>
<span><span class="co">#&gt; cg13 0.9630242 0.9022990 0.6907053 0.7954674 0.02461368</span></span>
<span><span class="co">#&gt; cg17 0.1428000 0.4145463 0.4137243 0.3688455 0.15244475</span></span>
<span><span class="co">#&gt; cg03        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg06        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg11        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg15        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg18        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weights</span></span>
<span><span class="co">#&gt;         cg02         cg03         cg06         cg07         cg08         cg11 </span></span>
<span><span class="co">#&gt; -0.009083377 -0.001155999  0.005978497 -0.007562015  0.001218960 -0.005869372 </span></span>
<span><span class="co">#&gt;         cg13         cg15         cg17         cg18 </span></span>
<span><span class="co">#&gt; -0.007449367  0.005066157  0.007900907 -0.002510744 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; Intercept </span></span>
<span><span class="co">#&gt;     1.211 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "methyl_surro"</span></span></code></pre></div>
<p>We can see that the resulting <code>methyl_surro</code> object has
three elements that correspond to the inputs: <code>methyl</code>,
<code>weights</code>, and <code>intercept</code>. In addition to placing
each of the inputs into their own object element, the function has also
subset the methylation matrix to include all of the probes included in
the weights (and nothing more). Although it makes little difference with
this toy example, methylation matrices in the real world contain hundeds
of thousands of probes, while many surrogates are constructed using tens
of thousands of probes.</p>
</div>
<div class="section level2">
<h2 id="handling-missing-values">Handling Missing Values<a class="anchor" aria-label="anchor" href="#handling-missing-values"></a>
</h2>
<p>Notice that there are a number of missing values in the
<code>methyl</code> element of <code>my_surrogate</code>. Our next step
is to address these.</p>
<div class="section level3">
<h3 id="two-types-of-missing-values">Two Types of Missing Values<a class="anchor" aria-label="anchor" href="#two-types-of-missing-values"></a>
</h3>
<p><code>MethylSurroGetR</code> distinguishes between two types of
missing values:</p>
<ul>
<li>
<font color="blue"><b>Missing Observatons:</b></font> These are
probes that were measured in the target data, with missing values for
some samples.
<ul>
<li>Notice that <code>cg01</code> was missing in our methylation matrix
for <code>samp2</code>, <code>samp3</code>, and <code>samp5</code>.
Similarly, <code>cg07</code> was missing for <code>samp5</code>.</li>
</ul>
</li>
<li>
<font color="red"><b>Missing Probes:</b></font> These are probes
that are not measured in the target data. Therefore, they are missing
for all samples in the methylation matrix. This might have occurred
because those probes was removed during QC or because the array did not
include the probes.
<ul>
<li>Notice that <code>cg03</code>, <code>cg06</code>, <code>cg11</code>,
<code>cg15</code>, and <code>cg18</code> were included among the
surrogate weights, but were not in our methylation data.</li>
</ul>
</li>
</ul>
<table class="table table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:center;">
samp1
</th>
<th style="text-align:center;">
samp2
</th>
<th style="text-align:center;">
samp3
</th>
<th style="text-align:center;">
samp4
</th>
<th style="text-align:center;">
samp5
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
cg02
</td>
<td style="text-align:center;">
0.288
</td>
<td style="text-align:center;">
<font color="blue"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="blue"><b>NA</b></font>
</td>
<td style="text-align:center;">
0.883
</td>
<td style="text-align:center;">
<font color="blue"><b>NA</b></font>
</td>
</tr>
<tr>
<td style="text-align:left;">
cg07
</td>
<td style="text-align:center;">
0.900
</td>
<td style="text-align:center;">
0.246
</td>
<td style="text-align:center;">
<font color="blue"><b>NA</b></font>
</td>
<td style="text-align:center;">
0.328
</td>
<td style="text-align:center;">
0.955
</td>
</tr>
<tr>
<td style="text-align:left;">
cg08
</td>
<td style="text-align:center;">
0.890
</td>
<td style="text-align:center;">
0.693
</td>
<td style="text-align:center;">
0.641
</td>
<td style="text-align:center;">
0.994
</td>
<td style="text-align:center;">
0.656
</td>
</tr>
<tr>
<td style="text-align:left;">
cg13
</td>
<td style="text-align:center;">
0.963
</td>
<td style="text-align:center;">
0.902
</td>
<td style="text-align:center;">
0.691
</td>
<td style="text-align:center;">
0.795
</td>
<td style="text-align:center;">
0.025
</td>
</tr>
<tr>
<td style="text-align:left;">
cg17
</td>
<td style="text-align:center;">
0.143
</td>
<td style="text-align:center;">
0.415
</td>
<td style="text-align:center;">
0.414
</td>
<td style="text-align:center;">
0.369
</td>
<td style="text-align:center;">
0.152
</td>
</tr>
<tr>
<td style="text-align:left;">
cg03
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
</tr>
<tr>
<td style="text-align:left;">
cg06
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
</tr>
<tr>
<td style="text-align:left;">
cg11
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
</tr>
<tr>
<td style="text-align:left;">
cg15
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
</tr>
<tr>
<td style="text-align:left;">
cg18
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
<td style="text-align:center;">
<font color="red"><b>NA</b></font>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="checking-for-missing-values">Checking for Missing Values<a class="anchor" aria-label="anchor" href="#checking-for-missing-values"></a>
</h3>
<p>Next, we can check our new methylation matrix for missing values.
This seems silly with our small example, but can be much more helpful
when working with real data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">missing</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/methyl_miss.html">methyl_miss</a></span><span class="op">(</span>methyl_surro <span class="op">=</span> <span class="va">my_surrogate</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">missing</span><span class="op">)</span></span>
<span><span class="co">#&gt; $missing_obs</span></span>
<span><span class="co">#&gt; cg02 cg07 </span></span>
<span><span class="co">#&gt;  0.6  0.2 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $missing_probes</span></span>
<span><span class="co">#&gt; [1] "cg03" "cg06" "cg11" "cg15" "cg18"</span></span></code></pre></div>
<p>Notice that the object created by <code><a href="../reference/methyl_miss.html">methyl_miss()</a></code> contains
an element for each type of missing data:</p>
<ul>
<li>For missing observations (<code>missing_obs</code>), the function
returns a named vector of the proportion of samples that are missing
each of the probes.</li>
<li>For missing probes (<code>missing_probes</code>), the function
returns a character vector of probes that are missing for all
samples.</li>
</ul>
</div>
<div class="section level3">
<h3 id="imputing-missing-observations">Imputing Missing Observations<a class="anchor" aria-label="anchor" href="#imputing-missing-observations"></a>
</h3>
<p>Now that we know about our missing values, we’ll begin addressing
them by imputing missing observations with <code><a href="../reference/impute_obs.html">impute_obs()</a></code>.
Required inputs to this function are the <code>methyl_surro</code>
object, a character string to denote the method (currently available
options are “mean” and “median”). The optional
<code>min_nonmiss_prop</code> option can be specified to impute
observations for only those probes that are above the specified
proportion of non-missing values.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/impute_obs.html">impute_obs</a></span><span class="op">(</span>methyl_surro <span class="op">=</span> <span class="va">my_surrogate</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_surrogate</span><span class="op">)</span></span>
<span><span class="co">#&gt; $methyl</span></span>
<span><span class="co">#&gt;          samp1     samp2     samp3     samp4      samp5</span></span>
<span><span class="co">#&gt; cg02 0.2875775 0.5852975 0.5852975 0.8830174 0.58529746</span></span>
<span><span class="co">#&gt; cg07 0.8998250 0.2460877 0.6070843 0.3279207 0.95450365</span></span>
<span><span class="co">#&gt; cg08 0.8895393 0.6928034 0.6405068 0.9942698 0.65570580</span></span>
<span><span class="co">#&gt; cg13 0.9630242 0.9022990 0.6907053 0.7954674 0.02461368</span></span>
<span><span class="co">#&gt; cg17 0.1428000 0.4145463 0.4137243 0.3688455 0.15244475</span></span>
<span><span class="co">#&gt; cg03        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg06        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg11        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg15        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; cg18        NA        NA        NA        NA         NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weights</span></span>
<span><span class="co">#&gt;         cg02         cg03         cg06         cg07         cg08         cg11 </span></span>
<span><span class="co">#&gt; -0.009083377 -0.001155999  0.005978497 -0.007562015  0.001218960 -0.005869372 </span></span>
<span><span class="co">#&gt;         cg13         cg15         cg17         cg18 </span></span>
<span><span class="co">#&gt; -0.007449367  0.005066157  0.007900907 -0.002510744 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; Intercept </span></span>
<span><span class="co">#&gt;     1.211 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "methyl_surro"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="filling-missing-probes-from-reference-data">Filling Missing Probes from Reference Data<a class="anchor" aria-label="anchor" href="#filling-missing-probes-from-reference-data"></a>
</h3>
<p>Now that we’ve imputed missing observations, we need to account for
missing probes (i.e., those that are missing for all samples). For this,
we’ll need to draw on a reference panel (<code>ref_vec_mean</code>) to
fill in values with the <code><a href="../reference/reference_fill.html">reference_fill()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ref_vec_mean"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ref_vec_mean</span><span class="op">)</span></span>
<span><span class="co">#&gt;      cg01      cg02      cg03      cg04      cg05      cg06      cg07      cg08 </span></span>
<span><span class="co">#&gt; 0.3992451 0.6616689 0.4948262 0.5278895 0.6770353 0.5526592 0.4940793 0.7745650 </span></span>
<span><span class="co">#&gt;      cg09      cg10      cg11      cg12      cg13      cg14      cg15      cg16 </span></span>
<span><span class="co">#&gt; 0.5281033 0.4982656 0.4566024 0.3856340 0.6752219 0.5866269 0.4004940 0.4996738 </span></span>
<span><span class="co">#&gt;      cg17      cg18      cg19      cg20 </span></span>
<span><span class="co">#&gt; 0.2984722 0.3923206 0.3747138 0.7031609</span></span></code></pre></div>
<p>We’ll need to specify our <code>methyl_surro</code> object, the
<code>reference</code> object (requires named vector, matrix, or data
frame), and the <code>type</code> of values to fill. Since we’ve already
accounted for missing observations, we’ll use
<code>type = "probes"</code> to fill missing probes. Alternatively, the
function can be used to fill missing observations
(<code>type = "obs"</code>), or missing observations and probes
simultaneously (<code>type = "all"</code>).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_surrogate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/reference_fill.html">reference_fill</a></span><span class="op">(</span>methyl_surro <span class="op">=</span> <span class="va">my_surrogate</span>,</span>
<span>                               reference <span class="op">=</span> <span class="va">ref_vec_mean</span>,</span>
<span>                               type <span class="op">=</span> <span class="st">"probes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">my_surrogate</span><span class="op">)</span></span>
<span><span class="co">#&gt; $methyl</span></span>
<span><span class="co">#&gt;          samp1     samp2     samp3     samp4      samp5</span></span>
<span><span class="co">#&gt; cg02 0.2875775 0.5852975 0.5852975 0.8830174 0.58529746</span></span>
<span><span class="co">#&gt; cg07 0.8998250 0.2460877 0.6070843 0.3279207 0.95450365</span></span>
<span><span class="co">#&gt; cg08 0.8895393 0.6928034 0.6405068 0.9942698 0.65570580</span></span>
<span><span class="co">#&gt; cg13 0.9630242 0.9022990 0.6907053 0.7954674 0.02461368</span></span>
<span><span class="co">#&gt; cg17 0.1428000 0.4145463 0.4137243 0.3688455 0.15244475</span></span>
<span><span class="co">#&gt; cg03 0.4948262 0.4948262 0.4948262 0.4948262 0.49482616</span></span>
<span><span class="co">#&gt; cg06 0.5526592 0.5526592 0.5526592 0.5526592 0.55265924</span></span>
<span><span class="co">#&gt; cg11 0.4566024 0.4566024 0.4566024 0.4566024 0.45660238</span></span>
<span><span class="co">#&gt; cg15 0.4004940 0.4004940 0.4004940 0.4004940 0.40049405</span></span>
<span><span class="co">#&gt; cg18 0.3923206 0.3923206 0.3923206 0.3923206 0.39232059</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $weights</span></span>
<span><span class="co">#&gt;         cg02         cg03         cg06         cg07         cg08         cg11 </span></span>
<span><span class="co">#&gt; -0.009083377 -0.001155999  0.005978497 -0.007562015  0.001218960 -0.005869372 </span></span>
<span><span class="co">#&gt;         cg13         cg15         cg17         cg18 </span></span>
<span><span class="co">#&gt; -0.007449367  0.005066157  0.007900907 -0.002510744 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $intercept</span></span>
<span><span class="co">#&gt; Intercept </span></span>
<span><span class="co">#&gt;     1.211 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "methyl_surro"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="estimating-predicted-surrogate-values">Estimating Predicted Surrogate Values<a class="anchor" aria-label="anchor" href="#estimating-predicted-surrogate-values"></a>
</h2>
<p>We’re finally ready to generate predicted values! To do this, we’ll
use the <code><a href="../reference/surro_calc.html">surro_calc()</a></code> function. We once again need to
specify <code>methyl_surro</code> object, as well as the
<code>transform</code> method. In this case, our surrogate weights were
created using an elastic net regression model with the Gaussian link
function, so we’ll use <code>transform = "linear"</code>. For surrogate
weights developed using the logit link function, predicted probabilities
can be estimated with <code>transform = "probability"</code>. For those
developed using the Poisson link function, predicted counts can be
generated with <code>transform = "count"</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/surro_calc.html">surro_calc</a></span><span class="op">(</span>methyl_surro <span class="op">=</span> <span class="va">my_surrogate</span>,</span>
<span>                        transform <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt;    samp1    samp2    samp3    samp4    samp5 </span></span>
<span><span class="co">#&gt; 1.197718 1.202317 1.201093 1.199796 1.201382</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="piping-commands-together">Piping Commands Together<a class="anchor" aria-label="anchor" href="#piping-commands-together"></a>
</h2>
<p>To simplify the process of estimating predicted surrogate values, we
can pipe the commands in a single string to clean up our code.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">estimates</span> <span class="op">&lt;-</span> <span class="va">beta_matrix_miss</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/surro_set.html">surro_set</a></span><span class="op">(</span>weights <span class="op">=</span> <span class="va">wts_vec_lin</span>, intercept <span class="op">=</span> <span class="st">"Intercept"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/impute_obs.html">impute_obs</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/reference_fill.html">reference_fill</a></span><span class="op">(</span>reference <span class="op">=</span> <span class="va">ref_vec_mean</span>, type <span class="op">=</span> <span class="st">"probes"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/surro_calc.html">surro_calc</a></span><span class="op">(</span>transform <span class="op">=</span> <span class="st">"linear"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">estimates</span><span class="op">)</span></span>
<span><span class="co">#&gt;    samp1    samp2    samp3    samp4    samp5 </span></span>
<span><span class="co">#&gt; 1.197718 1.202317 1.201093 1.199796 1.201382</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joshua A. Goode.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
